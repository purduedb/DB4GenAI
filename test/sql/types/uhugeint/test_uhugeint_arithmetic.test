# name: test/sql/types/uhugeint/test_uhugeint_arithmetic.test
# description: Test arithmetic with unsigned huge integers
# group: [uhugeint]

statement ok
PRAGMA enable_verification

# negation
query II
SELECT ~(-50::UHUGEINT), -(-(50::UHUGEINT));
----
49	50

# negate 0
query I
SELECT -(0::UHUGEINT)
----
0

# addition
# simple addition: small values
query I
SELECT 42::UHUGEINT + 42::UHUGEINT;
----
84

# large values
query I
SELECT '100000000000000000000'::UHUGEINT + '100000000000000000000'::UHUGEINT;
----
200000000000000000000

# overflow in addition
statement error
SELECT '340282366920938463463374607431768211455'::UHUGEINT + '340282366920938463463374607431768211455'::UHUGEINT;
----
Out of Range Error

statement error
SELECT '340282366920938463463374607431768211455'::UHUGEINT + '10'::UHUGEINT;
----
Out of Range Error

# almost overflowing but not quite
query I
SELECT '340282366920938463463374607431768211455'::UHUGEINT - 10::UHUGEINT + 10::UHUGEINT
----
340282366920938463463374607431768211455

# overflowing
statement error
SELECT '340282366920938463463374607431768211455'::UHUGEINT - 10::UHUGEINT + 11::UHUGEINT
----
Out of Range Error

# subtraction
query II
SELECT 100::UHUGEINT - 42::UHUGEINT, 3::UHUGEINT - 2::UHUGEINT;
----
58	1

# underflow in subtraction
statement error
SELECT '0'::UHUGEINT - '1'::UHUGEINT;
----
Out of Range Error

# multiplication
query I
SELECT 100::UHUGEINT * 50::UHUGEINT;
----
5000

# multiplying large numbers
query II
SELECT '1701411834604692317'::UHUGEINT * '2'::UHUGEINT, '100000000000000000000'::UHUGEINT * '1000000000000000000'::UHUGEINT
----
3402823669209384634	100000000000000000000000000000000000000

query I
SELECT '340282366920938463463374607431768211455'::UHUGEINT * 1::UHUGEINT
----
340282366920938463463374607431768211455

# overflow in multiplication
statement error
SELECT '340282366920938463463374607431768211455'::UHUGEINT * 2::UHUGEINT
----
Out of Range Error

statement error
SELECT '34028236692093846346'::UHUGEINT * '33746074317682114556'::UHUGEINT
----
Out of Range Error

# division
query II
SELECT 100::UHUGEINT // 20::UHUGEINT, 90::UHUGEINT // 20::UHUGEINT
----
5	4

# division by zero
query I
SELECT 100::UHUGEINT // 0::UHUGEINT
----
NULL

# large values
query II
SELECT '100000000000000000000000000000000000000'::UHUGEINT // '10000000000000'::UHUGEINT, '100000000000000000000000000000000000000'::UHUGEINT // '2'::UHUGEINT
----
10000000000000000000000000	50000000000000000000000000000000000000

# modulo
query II
SELECT 100::UHUGEINT % 20::UHUGEINT, 90::UHUGEINT % 20::UHUGEINT
----
0	10

# modulo by zero
query I
SELECT 100::UHUGEINT % 0::UHUGEINT
----
NULL

# large values
query II
SELECT '100000000000000000000000000000000000000'::UHUGEINT % '6587689457689375689735'::UHUGEINT, '100000000000000000000000000000000000000'::UHUGEINT % '3'::UHUGEINT
----
5396771390320972230850	1

# abs
query I
SELECT ABS('100'::UHUGEINT);
----
100

query I
SELECT '340282366920938463463374607431768211454'::UHUGEINT + 1;
----
340282366920938463463374607431768211455

# the other way around (i.e. move away from the overflow direction)
query I
SELECT '340282366920938463463374607431768211455'::UHUGEINT - 1;
----
340282366920938463463374607431768211454

# now the reverse: right side is big
query I
SELECT 1 + '340282366920938463463374607431768211454'::UHUGEINT;
----
340282366920938463463374607431768211455

statement error
SELECT 1::UHUGEINT + '340282366920938463463374607431768211455'::UHUGEINT;
----
Out of Range Error

# subtraction
query I
SELECT 1 - 1::UHUGEINT;
----
0

statement error
SELECT 0::UHUGEINT - 1::UHUGEINT;
----
Out of Range Error

# the other way around (i.e. move away from the overflow direction)
query I
SELECT '340282366920938463463374607431768211455'::UHUGEINT - 1;
----
340282366920938463463374607431768211454

# division
query I
SELECT '340282366920938463463374607431768211455'::UHUGEINT // 1;
----
340282366920938463463374607431768211455

query I
SELECT '340282366920938463463374607431768211455'::UHUGEINT // '340282366920938463463374607431768211455'::UHUGEINT;
----
1

# comparisons
query II
SELECT '5'::UHUGEINT <> '5'::UHUGEINT, '5'::UHUGEINT <> '18446744073709551621'::UHUGEINT
----
false	true
